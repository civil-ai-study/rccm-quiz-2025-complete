[
  {
    "test": "session_logic_analysis",
    "timestamp": "2025-07-07T08:53:49.850628",
    "analysis": {
      "session_pattern_findings": {
        "session['exam_session']": 10,
        "session['exam_session']_contexts": [
          {
            "line_number": 7243,
            "context": [
              "        store_exam_data_in_memory(exam_id, exam_session)",
              "        ",
              "        session['exam_session'] = lightweight_session",
              "        session.modified = True",
              "        "
            ]
          },
          {
            "line_number": 7376,
            "context": [
              "            result = exam_simulator.finish_exam(exam_session)",
              "            # HTTP 431å¯¾ç­–: è»½é‡ã‚»ãƒƒã‚·ãƒ§ãƒ³æ›´æ–°",
              "            session['exam_session'].update({",
              "                'status': 'completed',",
              "                'current_question': exam_session.get('current_question', 0),"
            ]
          },
          {
            "line_number": 7400,
            "context": [
              "",
              "        # HTTP 431å¯¾ç­–: è»½é‡ã‚»ãƒƒã‚·ãƒ§ãƒ³æ›´æ–°",
              "        session['exam_session'].update({",
              "            'current_question': exam_session.get('current_question', 0),",
              "            'answers': exam_session.get('answers', {})"
            ]
          }
        ],
        "session.get('exam_session'": 13,
        "session.get('exam_session'_contexts": [
          {
            "line_number": 76,
            "context": [
              "    \"\"\"",
              "    try:",
              "        exam_session = session.get('exam_session', {})",
              "        question_ids = exam_session.get('question_ids', [])",
              "        "
            ]
          },
          {
            "line_number": 108,
            "context": [
              "    \"\"\"",
              "    try:",
              "        exam_session = session.get('exam_session', {})",
              "        current_question_index = exam_session.get('current_question', 0)",
              "        question_ids = exam_session.get('question_ids', [])"
            ]
          },
          {
            "line_number": 184,
            "context": [
              "    \"\"\"è»½é‡åŒ–ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å‹•çš„ãƒ­ãƒ¼ãƒ‰\"\"\"",
              "    try:",
              "        exam_session = session.get('exam_session', {})",
              "        question_ids = exam_session.get('question_ids', [])",
              "        "
            ]
          }
        ],
        "4-1/4-2å®Œå…¨åˆ†é›¢": 1,
        "4-1/4-2å®Œå…¨åˆ†é›¢_contexts": [
          {
            "line_number": 7224,
            "context": [
              "        }",
              "        ",
              "        logger.info(f\"ğŸ›¡ï¸ 4-1/4-2å®Œå…¨åˆ†é›¢: {question_type_check}ã§{len(selected_questions)}å•é¸æŠå®Œäº†\")",
              "        logger.info(f\"ğŸ”¥ EXAM START: è©¦é¨“ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”Ÿæˆå®Œäº† - ID: {exam_session.get('exam_id', 'UNKNOWN')}\")",
              ""
            ]
          }
        ],
        "question_type_check": 4,
        "question_type_check_contexts": [
          {
            "line_number": 7195,
            "context": [
              "        ",
              "        # 4-1ã¨4-2ã®æ··åœ¨ã‚’é˜²ãæœ€çµ‚ãƒã‚§ãƒƒã‚¯",
              "        question_type_check = session.get('selected_question_type', '')",
              "        if question_type_check == 'basic':",
              "            # åŸºç¤ç§‘ç›®ã®å ´åˆï¼šå°‚é–€ç§‘ç›®ãŒæ··å…¥ã—ã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯"
            ]
          },
          {
            "line_number": 7196,
            "context": [
              "        # 4-1ã¨4-2ã®æ··åœ¨ã‚’é˜²ãæœ€çµ‚ãƒã‚§ãƒƒã‚¯",
              "        question_type_check = session.get('selected_question_type', '')",
              "        if question_type_check == 'basic':",
              "            # åŸºç¤ç§‘ç›®ã®å ´åˆï¼šå°‚é–€ç§‘ç›®ãŒæ··å…¥ã—ã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯",
              "            contaminated = [q for q in selected_questions if q.get('question_type') != 'basic']"
            ]
          },
          {
            "line_number": 7202,
            "context": [
              "                logger.error(f\"ğŸš¨ åŸºç¤ç§‘ç›®ã«å°‚é–€ç§‘ç›®æ··å…¥æ¤œå‡º: {len(contaminated)}å• - é™¤å»ã—ã¾ã™\")",
              "                selected_questions = [q for q in selected_questions if q.get('question_type') == 'basic']",
              "        elif question_type_check == 'specialist':",
              "            # å°‚é–€ç§‘ç›®ã®å ´åˆï¼šåŸºç¤ç§‘ç›®ãŒæ··å…¥ã—ã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯",
              "            contaminated = [q for q in selected_questions if q.get('question_type') != 'specialist']"
            ]
          }
        ],
        "åŸºç¤ç§‘ç›®ã«å°‚é–€ç§‘ç›®æ··å…¥æ¤œå‡º": 2,
        "åŸºç¤ç§‘ç›®ã«å°‚é–€ç§‘ç›®æ··å…¥æ¤œå‡º_contexts": [
          {
            "line_number": 2164,
            "context": [
              "                                      if q.get('question_type') == 'specialist' and int(q.get('id', 0)) in [int(aq.get('id', 0)) for aq in available_questions]]",
              "            if specialist_contamination:",
              "                logger.error(f\"ğŸš¨ åŸºç¤ç§‘ç›®ã«å°‚é–€ç§‘ç›®æ··å…¥æ¤œå‡º: {len(specialist_contamination)}å•\")",
              "                available_questions = [q for q in available_questions if q not in specialist_contamination]",
              ""
            ]
          },
          {
            "line_number": 7200,
            "context": [
              "            contaminated = [q for q in selected_questions if q.get('question_type') != 'basic']",
              "            if contaminated:",
              "                logger.error(f\"ğŸš¨ åŸºç¤ç§‘ç›®ã«å°‚é–€ç§‘ç›®æ··å…¥æ¤œå‡º: {len(contaminated)}å• - é™¤å»ã—ã¾ã™\")",
              "                selected_questions = [q for q in selected_questions if q.get('question_type') == 'basic']",
              "        elif question_type_check == 'specialist':"
            ]
          }
        ],
        "å°‚é–€ç§‘ç›®ã«åŸºç¤ç§‘ç›®æ··å…¥æ¤œå‡º": 2,
        "å°‚é–€ç§‘ç›®ã«åŸºç¤ç§‘ç›®æ··å…¥æ¤œå‡º_contexts": [
          {
            "line_number": 2179,
            "context": [
              "                                 if q.get('question_type') == 'basic' and int(q.get('id', 0)) in [int(aq.get('id', 0)) for aq in available_questions]]",
              "            if basic_contamination:",
              "                logger.error(f\"ğŸš¨ å°‚é–€ç§‘ç›®ã«åŸºç¤ç§‘ç›®æ··å…¥æ¤œå‡º: {len(basic_contamination)}å•\")",
              "                available_questions = [q for q in available_questions if q not in basic_contamination]",
              ""
            ]
          },
          {
            "line_number": 7206,
            "context": [
              "            contaminated = [q for q in selected_questions if q.get('question_type') != 'specialist']",
              "            if contaminated:",
              "                logger.error(f\"ğŸš¨ å°‚é–€ç§‘ç›®ã«åŸºç¤ç§‘ç›®æ··å…¥æ¤œå‡º: {len(contaminated)}å• - é™¤å»ã—ã¾ã™\")",
              "                selected_questions = [q for q in selected_questions if q.get('question_type') == 'specialist']",
              "        "
            ]
          }
        ],
        "lightweight_session": 6,
        "lightweight_session_contexts": [
          {
            "line_number": 71,
            "context": [
              "",
              "# ğŸ›¡ï¸ HTTP 431å¯¾ç­–: è»½é‡ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”¨å•é¡Œãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½",
              "def load_questions_from_lightweight_session(session, data_manager=None):",
              "    \"\"\"",
              "    è»½é‡åŒ–ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å®Œå…¨ãªå•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ"
            ]
          },
          {
            "line_number": 103,
            "context": [
              "        return []",
              "",
              "def get_current_question_from_lightweight_session(session, data_manager=None):",
              "    \"\"\"",
              "    è»½é‡åŒ–ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰ç¾åœ¨ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—"
            ]
          },
          {
            "line_number": 181,
            "context": [
              "",
              "# ğŸ›¡ï¸ HTTP 431å¯¾ç­–: è»½é‡ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”¨å•é¡Œãƒ‡ãƒ¼ã‚¿å¾©å…ƒæ©Ÿèƒ½",
              "def load_question_from_lightweight_session(session, question_index=None):",
              "    \"\"\"è»½é‡åŒ–ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å‹•çš„ãƒ­ãƒ¼ãƒ‰\"\"\"",
              "    try:"
            ]
          }
        ],
        "store_exam_data_in_memory": 2,
        "store_exam_data_in_memory_contexts": [
          {
            "line_number": 160,
            "context": [
              "EXAM_DATA_CACHE = {}",
              "",
              "def store_exam_data_in_memory(exam_id, exam_session):",
              "    \"\"\"è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒ¢ãƒªã«ä¸€æ™‚ä¿å­˜\"\"\"",
              "    global EXAM_DATA_CACHE"
            ]
          },
          {
            "line_number": 7241,
            "context": [
              "        # ãƒ¡ãƒ¢ãƒªã«è©¦é¨“ãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å¤–ï¼‰",
              "        exam_id = exam_session.get('exam_id', '')",
              "        store_exam_data_in_memory(exam_id, exam_session)",
              "        ",
              "        session['exam_session'] = lightweight_session"
            ]
          }
        ]
      },
      "separation_logic": {
        "contamination_detection": {
          "basic_contamination": true,
          "specialist_contamination": true,
          "automatic_removal": true
        },
        "question_type_check": {
          "has_type_check": true,
          "basic_check": true,
          "specialist_check": true
        },
        "session_isolation": {
          "lightweight_session": true,
          "memory_storage": true,
          "session_modification": true
        }
      },
      "potential_issues": [
        "ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®ç›´æ¥å¤‰æ›´ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ",
        "è¤‡æ•°ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚­ãƒ¼ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™: ['exam_session', 'exam_question_ids', 'exam_current', 'exam_category']"
      ]
    }
  },
  {
    "test": "csv_separation_verification",
    "status": "PASSED",
    "4_1_analysis": {
      "question_count": 202,
      "id_range": "1-202",
      "categories": [
        "å…±é€š"
      ],
      "is_basic_only": true
    },
    "4_2_analysis": {
      "question_count": 361,
      "id_range": "203-563",
      "categories": [
        "éƒ½å¸‚è¨ˆç”»åŠã³åœ°æ–¹è¨ˆç”»",
        "æ²³å·ã€ç ‚é˜²åŠã³æµ·å²¸ãƒ»æµ·æ´‹",
        "é“è·¯",
        "é€ åœ’",
        "ãƒˆãƒ³ãƒãƒ«",
        "è¾²æ¥­åœŸæœ¨",
        "åœŸè³ªåŠã³åŸºç¤",
        "æ£®æ—åœŸæœ¨",
        "é‹¼æ§‹é€ åŠã³ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆ",
        "å»ºè¨­ç’°å¢ƒ",
        "æ–½å·¥è¨ˆç”»ã€æ–½å·¥è¨­å‚™åŠã³ç©ç®—",
        "ä¸Šæ°´é“åŠã³å·¥æ¥­ç”¨æ°´é“"
      ],
      "is_specialist_only": true
    },
    "separation_quality": {
      "no_id_overlap": true,
      "no_category_overlap": true,
      "clear_boundaries": true
    }
  },
  {
    "test": "data_loading_logic_verification",
    "status": "PASSED",
    "bom_handling": {
      "bom_detection": true,
      "bom_removal": true,
      "encoding_fallback": true
    },
    "error_handling": {
      "unicode_decode_error": true,
      "file_not_found_error": true,
      "data_validation_error": true,
      "multiple_encoding_attempts": true
    },
    "cache_features": {
      "has_cache": true,
      "redis_cache": true,
      "memory_cache": false
    }
  }
]